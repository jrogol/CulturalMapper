# query data within data range relative to timezone and filter out unneeded sources
LA_Sql = "WITH casted AS(SELECT id, CAST(created_at as timestamptz) as created_at, source, text_lang, user_id, user_lang FROM la_city_primary WHERE source ILIKE ANY(ARRAY['%for Blackberry%', '%for Android%', '%tron%', '%Foursquare%', '%Instagram%', '%for iOS%', '%for iPhone%', '%for Windows Phone%', '%for iPad%', 'Twitter Web Client', '%for Mac%']) ) SELECT timezone('America/Los_Angeles', created_at) as tzone, text_lang, user_lang, user_id, source FROM casted WHERE timezone('America/Los_Angeles', created_at) > '2016-10-28' AND timezone('America/Los_Angeles', created_at) < '2017-01-28' AND user_lang = 'ar'"

Chicago_Sql = "WITH casted AS(SELECT id, CAST(created_at as timestamptz) as created_at, source, text_lang, user_id, user_lang FROM chicago_city_primary WHERE source ILIKE ANY(ARRAY['%for Blackberry%', '%for Android%', '%tron%', '%Foursquare%', '%Instagram%', '%for iOS%', '%for iPhone%', '%for Windows Phone%', '%for iPad%', 'Twitter Web Client', '%for Mac%']) ) SELECT timezone('America/Chicago', created_at) as tzone, text_lang, user_lang, user_id, source FROM casted WHERE timezone('America/Chicago', created_at) > '2016-10-28' AND timezone('America/Chicago', created_at) < '2017-01-28' AND user_lang = 'ar'"

Istanbul_Sql = "WITH casted AS(SELECT id, CAST(created_at as timestamptz) as created_at, source, text_lang, user_id, user_lang FROM istanbul_city_primary WHERE source ILIKE ANY(ARRAY['%for Blackberry%', '%for Android%', '%tron%', '%Foursquare%', '%Instagram%', '%for iOS%', '%for iPhone%', '%for Windows Phone%', '%for iPad%', 'Twitter Web Client', '%for Mac%']) ) SELECT timezone('Europe/Istanbul', created_at) as tzone, text_lang, user_lang, user_id, source FROM casted WHERE timezone('Europe/Istanbul', created_at) > '2016-10-28' AND timezone('Europe/Istanbul', created_at) < '2017-01-28' AND user_lang = 'ar'"
